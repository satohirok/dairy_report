# 達人に学ぶDB設計 メモ

## 1章:データベースを制するものはシステムを制す
* データベースを使わないシステムはこの世に存在せず、システムは基本的にデータベースに合わせて作られる。(データ中心アプローチ)
* 情報はデータ(事実)と文脈（事実からの推測、観点）を合成して生まれる。
* データベース管理システム(Oracle,MySQL,PostgreSQL,SQLServer)によって、設計が影響を受けることはない。→基礎根幹の部分を抑えることが大切。
* ソフトウェアというのは、「データの流通機構」なのでデータ設計がシステムの品質を大きく左右する。
* スキーマ(枠組み、構図)
  * ``外部スキーマ``:ユーザーから見えるデータベースのこと。(画面のユーザーインターフェイスや入力データなど)
  * ``概念スキーマ``:開発者からみたデータベースのこと。（論理設計：正規化→ER図）
  * ``内部スキーマ``:DBMSから見たデータベースのこと。(物理設計:ファイルで表現される世界)
  * 外部スキーマと内部スキーマの``2層スキーマ``では、スキーマ同士の結合度が高いので、変更に弱いシステムになってしまう。
  * 上記の2層スキーマの``緩衝材(2つのスキーマのデータ独立性を高める)``の役割として、概念スキーマが存在する。
* 演習:アプリケーション改修のタイプとコスト
  * 問題1:
  * 問題2:
 
## 2章:論理設計と物理設計（?な用語・概念が多いので後で見直し、整理）
* 論理設計
  * エンティティの抽出→エンティティの定義→正規化→ER図の作成
* 物理設計
  * サイジング
  * RAID
  * ファイルの物理配置
* バックアップ設計
* リカバリ設計

## 3章:論理設計と正規化
* テーブルは共通点を持ったレコード(同じ種類のもの)の集合のことである。
* テーブル名は英語ならば複数形/複数名詞で書くことができる。そうでなければそのテーブルにはどこか間違いがある。
* テーブルの構成要素
  * ``行と列``:テーブルにおける横と縦のデータの組のこと 
  * ``主キー``:テーブルに置いて必ず１つ存在しなければならず、かつ１つしか存在しないもの。主キーを用いることで行のレコードを一意に識別することができる。
  * RSBMのテーブルに重複行は存在することができない。
  * ``外部キー``:２つのテーブル間同士で設定するもの。2つのテーブルの結合度を高めることで、テーブルに対して``制約``を課すことができる。（参照整合性制約）
  * キーの整合性を保つためにも、キーに使用する列は必ず何らかのコードとIDといった表記体系の定まったデータを``固定長文字列``のデータ型に格納して使用する必要がある。
  * テーブルや列の名前に日本語はNG
* 正規化:データベースで保持する冗長性を排除し、一貫性と効率性を保持するためのデータ形式。
  * 冗長なデータを保持していると、更新処理のタイムラグによってデータの不整合が発生したり、そもそもデータを登録できないようなテーブルを作ってしまうことがある。
  * 正規化は１〜5まであるが、実務では３まで理解すれば十分事足りる。
* 第1正規化:１つのセルの中には１つの値しか含まない。
  * セルに複数の値を許すと、主キーが各列の値を一意に決定することができなくなってしまう。
  * ``関数従属性``:２つの属性感で、片方の値を決定するともう一方の値も一意に決まる性質のこと。
* 第2正規化:部分関数従属を解消する
  * ``部分関数従属``:主キーの一部の列に対して従属する列があること。(?→確認)
  * 現実世界の実体間にある階層の差を反映させる。（例:会社情報と社員情報でテーブルを分ける→どちらかを変更、更新しても矛盾が生じない。→変更に強くなる）
  * ``結合``:分割したテーブルはINNER JOIN で元に戻すことができる。
* 第3正規化:テーブル内の推移的関数従属によるデータ登録時の不都合を解消する
  * ``推移的関数従属``:テーブル内部に存在する段階的な従属関係。
* （※第4、第５正規化については省略）
